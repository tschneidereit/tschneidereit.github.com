
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>SwiftSuspenders 1.6: A Tale of Small Changes and Big Plans - Till Schneidereit</title>
  <meta name="author" content="Till Schneidereit">

  
  <meta name="description" content="I just released version 1.6 of my not-so-small-anymore IoC container
SwiftSuspenders. This
release marks the end of the line for 1.x-releases, all &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tschneidereit.github.io/2011/02/05/swiftsuspenders-1-6-a-tale-of-small-changes-and-big-plans">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/" rel="alternate" title="Till Schneidereit" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-10759382-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Till Schneidereit</a></h1>
  
    <h2>Virtualizing machines since not that long</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed/" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tschneidereit.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">SwiftSuspenders 1.6: A Tale of Small Changes and Big Plans</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-05T16:15:28+01:00" pubdate data-updated="true">Feb 5<span>th</span>, 2011</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>I just released version 1.6 of my not-so-small-anymore IoC container
<a href="https://github.com/tschneidereit/SwiftSuspenders">SwiftSuspenders</a>. This
release marks the end of the line for 1.x-releases, all future development
work will go towards the all-new, shiny 2.0 release. Bug fixing will continue
as per usual, of course.</p>

<h3>Small Changes?</h3>

<p>Yes &ndash; in 1.6:</p>

<ul>
<li><p>An easy but nevertheless significant performance optimizations for child injectors: Through a slight refactoring of the InjectionPoint class, I was able to make it fully independent from the injector that creates them, enabling them to be shared among all injectors in the VM instance. This allows them to be cached once, removing the significant performance overhead associated in inspecting classes to find injection points for all but the first injector.</p></li>
<li><p>Some usability improvements such as better error, warning and info messages on trying to instantiate interfaces, re-mapping previously mapped types and construction of dummy instances to work around Flash Player bugs.</p></li>
</ul>


<h3>Right, but Big Plans?</h3>

<p>Indeed &ndash; for 2.0!</p>

<p>For the next major release, I plan to change things up quite a bit. The main
features on the roadmap are:</p>

<ul>
<li>a much nicer API</li>
<li>factory mappings</li>
<li>field mappings</li>
<li>live injections</li>
<li>optional injections</li>
<li>weak mappings in child injectors</li>
<li>full live-cycle management with [PreDestroy] annotations</li>
<li>a new format for external, runtime-loadable definition of both injection points and type mappings</li>
<li>full implementation of the <a href="https://github.com/darscan/AS3-DI-Metadata">metadata standardization</a> <a href="http://twitter.com/darscan">@darscan</a> started, for example:</li>
<li>optionally shortening <code>[Inject(name='name')]</code> to <code>[Inject('name')]</code></li>
</ul>


<h3>That sounds just swell, but I&rsquo;d really like some details, please!</h3>

<p>Of course you do!</p>

<h4>The shiny new API</h4>

<p>SwiftSuspenders&#8217; API mainly consists of methods that facilitate the mapping of
types (and, optionally, names) to responses. Internally, this already is a
two-step process: First, an object is created that contains the request
configuration (i.e., the type and the optional name) and second, this request
is assigned a response of a certain type: A value, class, singleton or rule
mapping.</p>

<p>While 2.0 will ship with a fa√ßade to make porting from 1.x easy, the real
interface will expose this process as the two steps it really is. Look forward
to seeing mapping commands that look (approximately) like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='as3'><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourClass</span><span class="o">);</span> <span class="c1">//current equivalent: injector.mapClass(YourClass, YourClass);</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourClass</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">);</span> <span class="c1">//current equivalent: injector.mapClass(YourClass, YourClass, &#39;name&#39;);</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourClass</span><span class="o">).</span><span class="n">to</span><span class="o">(</span><span class="n">YourClass</span><span class="o">);</span> <span class="c1">//equivalent to the first mapping (i.e.: optional)</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourClass</span><span class="o">,</span> <span class="s1">&#39;name&#39;</span><span class="o">).</span><span class="n">to</span><span class="o">(</span><span class="n">YourClass</span><span class="o">);</span> <span class="c1">//equivalent to the second mapping (i.e.: optional)</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourInterface</span><span class="o">).</span><span class="n">toType</span><span class="o">(</span><span class="n">YourClass</span><span class="o">);</span> <span class="c1">//current equivalent: injector.mapClass(YourInterface, YourClass);</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourClass</span><span class="o">).</span><span class="n">asSingleton</span><span class="o">();</span> <span class="c1">//current equivalent: injector.mapSingleton(YourClass);</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourInterface</span><span class="o">).</span><span class="n">toType</span><span class="o">(</span><span class="n">YourClass</span><span class="o">).</span><span class="n">asSingleton</span><span class="o">();</span> <span class="c1">//current equivalent: injector.mapSingletonOf(YourInterface, YourClass);</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourInterface</span><span class="o">).</span><span class="n">toValue</span><span class="o">(</span><span class="n">value</span><span class="o">);</span> <span class="c1">//current equivalent: injector.mapValue(YourInterface, value);</span>
</span><span class='line'><span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourInterface</span><span class="o">).</span><span class="n">toRule</span><span class="o">(</span><span class="n">otherRule</span><span class="o">);</span> <span class="c1">//current equivalent: injector.mapRule(YourInterface, otherRule);</span>
</span><span class='line'><span class="kd">var</span> <span class="n">request</span> <span class="p">:</span> <span class="kt">InjectionRequest</span> <span class="o">=</span> <span class="n">injector</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">YourClass</span><span class="o">);</span> <span class="c1">//current equivalent: var request : InjectionConfig = injector.getMapping(YourClass);</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Basically, the API will be somewhat more DSL-ish, without going all the way
into that direction, though: I like to think of it as bundling up all
parameters related to one concept in one method call: First everything related
to <em>what</em> gets mapped, then, optionally, <em>to what</em> it gets mapped and finally,
<em>how</em> its being mapped.</p>

<p>Additionally, the small rest of the API will be subject to some tweaks, I
suppose.</p>

<h4>Factory mappings</h4>

<p>I haven&rsquo;t really gotten through the concept phase for these. The absolute
minimum is support for <code>injector.map().toFactory()</code> and
<code>injector.map().toFactoryMethod()</code>, but if I come up with some clever
mechanism for parameterizing specific injections, I would like to support that
as well.</p>

<h4>Field mappings</h4>

<p>In order to turn SwiftSuspenders into a light-weight one-way binding solution,
2.0 will support mapping of fields in objects with
<code>injector.map().toField(fieldName, inObject)</code>. If the mapped field is
bindable, SwiftSuspenders will listen to its change events and update the
affected live injections:</p>

<h4>Live injections</h4>

<p>Now those are something I&rsquo;m really looking forward to. By specifying the
<code>live</code>-parameter in your <code>Inject</code>-metadata (as in <code>[Inject(live)]</code>), you
basically create a one-way binding that updates the value as soon as the
associated mapping changes or, in the case of field mappings, the relevant
binding event is dispatched as described above.</p>

<h4>Optional injections</h4>

<p>These are exactly what you think they are. <code>[Inject(optional)]</code> will instruct
the injector not to throw an exception if it can&rsquo;t find a mapping for the
requested type.</p>

<h4>Weak mappings</h4>

<p>Imagine you have a module that you want to test &ndash; or perhaps even deploy &ndash;
standalone but <em>also</em> want to load into a bigger application. Now this module
might have some configuration that&rsquo;s different based on what context it gets
loaded into. If its loaded into another application, all or parts of the
configuration should be supplied by that application, but if its running
standalone, it has to deal with configuration all by itself. Enter weak
mappings: These instruct the injector to always ask its parent injector if it
has a mapping for the injection request. Only if that returns empty, the
weakly mapped value, in this case the module&rsquo;s configuration, is used.</p>

<h4>Tear-down with [PreDestroy]</h4>

<p>Just as <code>[Inject]</code> is used to build object graphs, <code>[PreDestroy]</code> facilitates
tearing them down. When instructed to destroy a certain instance that it
created itself or that was injected into with <code>injector.injectInto</code>,
SwiftSuspenders will first go through all injection points in the instance and
destroy those recursively (if they are only used by this instance, not if they
are singleton or value mappings, of course) and the invoke all methods marked
with <code>[PreDestroy]</code> metadata.</p>

<p>This will probably be used to replace the currently hard-coded <code>preRemove</code> and
<code>onRemove</code> methods in Robotlegs mediators.</p>

<h4>New runtime-loadable configuration format for injection points and mappings</h4>

<p>The current XML-based configuration format was solely meant to work around
restrictions in the Flash CS* AS3 compiler which doesn&rsquo;t support custom
metadata out of the box. This problem has since been <a href="http://www.patrickmowrer.com/2010/03/03/compiling-custom-as3-metadata-flash-professional">worked around</a>, rendering the format obsolete as it is right now. As
quite some people expressed interest in being able to mix hard-coded and
runtime-loaded configuration, I will try to come up with a good format for
that. For now, I don&rsquo;t have anything in that direction, so we&rsquo;ll see how that
goes. And if <em>you</em> want to define just such a format: Please do (and tell me
about it).</p>

<h4>Standardization FTW</h4>

<p>One thing I like about Robotlegs is how @darscan went to great lengths to
prevent as much lock-in as possible: Not only is the <a href="https://github.com/robotlegs/robotlegs-framework/blob/master/src/org/robotlegs/core/">framework&rsquo;s core</a>
just a set of interfaces that
makes it easy to roll your own for each part, the framework specifically tries
to make as many parts of your application independent and even ignorant of its
existence as possible. Toward that end, Shaun started a <a href="https://github.com/darscan/AS3-DI-Metadata">metadata standardization effort</a> with the
goal of getting as much agreement on the format of injection point-
configuration metadata as possible between the various IoC containers out
there.</p>

<p>And while I like to think of SwiftSuspenders (especially in its future
2.0-form) as being a pretty decent IoC container implementation, you should
definitely check out <a href="http://github.com/sophistifunk/SmartyPants-IOC">SmartyPants</a>, <a href="http://swizframework.org/">Swiz</a>, <a href="https://github.com/sammyt/dawn">Dawn</a>,
<a href="http://www.spicefactory.org/parsley/index.php">Spicelib</a> and other IoC
containers if only out of interest. I&rsquo;d also like for you to tell me of you
don&rsquo;t like SwiftSuspenders or you think it&rsquo;s missing some Very Important
Feature, though. Anyway, to allow you to switch from or to SwiftSuspenders as
painlessly as possible, I&rsquo;ll implement as much of whatever everyone decides
upon as possible in 2.0 and future releases.</p>

<h3>That&rsquo;s quite a lot of work you just described. You really think you can handle all of it for 2.0?</h3>

<p>Yeah, I know: This sounds like (and is) a lot. I&rsquo;ll pack all of this up in the
form of a roadmap on the github wiki, prioritizing stuff and distributing it
across beta releases. Depending on when it makes sense to do a new major
release (which in turn depends on when we decide to release Robotlegs 2.0), I
<em>might</em> let one or two of the described features slip into 2.*.</p>

<p><strong>But</strong>, some of these features already exist in forks other people published on github and which I was very bad at keeping up with. It is my hope that I can integrate much of these other great people&rsquo;s hard work instead of doing much myself.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">till</span></span>

      








  


<time datetime="2011-02-05T16:15:28+01:00" pubdate data-updated="true">Feb 5<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/categories/actionscript/'>ActionScript</a>, <a class='category' href='/categories/projects/'>Projects</a>, <a class='category' href='/categories/swiftsuspenders/'>swiftsuspenders</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://tschneidereit.github.io/2011/02/05/swiftsuspenders-1-6-a-tale-of-small-changes-and-big-plans/" data-via="tschneidereit" data-counturl="http://tschneidereit.github.io/2011/02/05/swiftsuspenders-1-6-a-tale-of-small-changes-and-big-plans/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2011/01/14/dictionaries-in-as3-a-tale-of-awesomeness-and-restrictions/" title="Previous Post: Dictionaries in AS3: A tale of awesomeness and restrictions">&laquo; Dictionaries in AS3: A tale of awesomeness and restrictions</a>
      
      
        <a class="basic-alignment right" href="/2011/10/22/mario-mushroom-now-with-80-less-awesome/" title="Next Post: Mario Mushroom: Now with 80% less awesome">Mario Mushroom: Now with 80% less awesome &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/04/03/on-brendans-success/">On Brendan's Success</a>
      </li>
    
      <li class="post">
        <a href="/2012/05/14/editing-git-commit-messages-with-sublime-text-2/">Editing Git and Mercurial Commit Messages With Sublime Text 2</a>
      </li>
    
      <li class="post">
        <a href="/2012/05/09/setting-up-cdt-to-work-on-spidermonkey/">Setting Up Eclipse CDT To Work On SpiderMonkey</a>
      </li>
    
      <li class="post">
        <a href="/2011/12/13/on-beginnings/">On Beginnings</a>
      </li>
    
      <li class="post">
        <a href="/2011/10/23/flash-cs5-and-version-control-of-binary-data-and-wasted-bandwidth/">Flash >= CS5 and version control: Of binary data and wasted bandwidth</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/tschneidereit">@tschneidereit</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'tschneidereit',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("tschneidereit", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/tschneidereit" class="twitter-follow-button" data-show-count="false">Follow @tschneidereit</a>
  
</section>

<section>
  <h1>Sometimes, I speak</h1>
  <a href='http://www.fitc.ca/events/speakers/speaker.cfm?event=125&speaker_id=13275' target='_blank'><img src='/images/badges/AM12_Speaker.jpg'/></a>
  <a href='http://www.tryharder.org.uk/' target='_blank'><img src='/images/badges/i_will_try_harder.jpg'/></a>
  <a href='http://www.beyondtellerrand.com/ffk11/speakers_sessions.php#schneidereit' target='_blank'><img src='/images/badges/ffk11.png'/></a>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Till Schneidereit -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'tillschneidereit';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://tschneidereit.github.io/2011/02/05/swiftsuspenders-1-6-a-tale-of-small-changes-and-big-plans/';
        var disqus_url = 'http://tschneidereit.github.io/2011/02/05/swiftsuspenders-1-6-a-tale-of-small-changes-and-big-plans/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
